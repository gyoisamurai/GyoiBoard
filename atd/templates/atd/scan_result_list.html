{% extends "atd/base.html" %}

{% block title %}Scan Result List{% endblock title %}

{% block content %}
<h4 class="mt-4 border-bottom">Scan Result List >> {{ target.id }}.{{ target.name }}</h4>

<style>
  #about .table_target_info th {
    width: 940px;
    background-color: #f0f0f0;
    padding: 12px 0;
    border: 1px solid #cccccc;
  }

  #about .table_target_info td {
    width: 940px;
    border: 1px solid #cccccc;
    text-align: left;
    padding: 0 0 0 10px;
  }

  #about .table_target_info tr th:nth-child(1) {
    width: 200px;
    text-align: center;
    vertical-align: center;
  }
</style>

<table class="table_target_info">
  <tr>
    <th>Model path</th>
    <td>{{ target.target_path }}</td>
  </tr>
</table>

<table class="table table-striped">
  <thead>
  <tr>
    <th>No</th>
    <th>Operation Type</th>
    <th>Attack Type</th>
    <th>Attack Method</th>
    <th>Status</th>
    <th>Rank</th>
    <th>Scan Date</th>
    <th>Report</th>
    <th></th>
  </tr>
  </thead>
  <tbody>
  {% for scan_detail in scan_details %}
  <tr>
    <td>{{ scan_detail.id }}</td>
    <td>{{ scan_detail.operation_type }}</td>
    <td>{{ scan_detail.attack_type }}</td>
    <td>{{ scan_detail.attack_method }}</td>
    <td>{{ scan_detail.status }}</td>
    <td>{{ scan_detail.rank }}</td>
    <td>{{ scan_detail.exec_end_date }}</td>
    <td>
      {% if scan_detail.scan_id %}
      <form action="{% url 'atd:show_report' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="scan_id" value="{{ scan_detail.scan_id }}">
        <input type="hidden" name="attack_type" value="{{ scan_detail.attack_type }}">
        <input type="hidden" name="attack_method" value="{{ scan_detail.attack_method }}">
        <button type="submit" class="btn btn-primary">show</button>
      {% else %}
      <form action="{% url 'atd:target_list' %}" method="get">
      {% endif %}
      </form>
    </td>
    <td>
      {% if scan_detail.scan_id %}
      <form action="{% url 'atd:download_report' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="scan_id" value="{{ scan_detail.scan_id }}">
        <button type="submit" class="btn btn-success">download</button>
      {% else %}
      <form action="{% url 'atd:target_list' %}" method="get">
      {% endif %}
      </form>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
<a href="{% url 'atd:target_list' %}" class="btn btn-secondary btn-sm">Back</a>
{% endblock content %}
