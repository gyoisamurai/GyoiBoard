{% extends "atd/base.html" %}

{% block title %}Scan Result List{% endblock title %}

{% block content %}
<h4 class="mt-4 border-bottom">Scan Result List >> {{ target.id }}.{{ target.name }}</h4>

<style>
  #about .table_target_info th {
    width: 940px;
    background-color: #f0f0f0;
    padding: 12px 0;
    border: 1px solid #cccccc;
  }

  #about .table_target_info td {
    width: 940px;
    border: 1px solid #cccccc;
    text-align: left;
    padding: 0 0 0 10px;
  }

  #about .table_target_info tr th:nth-child(1) {
    width: 200px;
    text-align: center;
    vertical-align: center;
  }
</style>

<table class="table_target_info">
  <tr>
    <th>Model path</th>
    <td>{{ target.target_path }}</td>
  </tr>
</table>

<table class="table table-striped table-bordered">
  <thead>
  <tr>
    <th>No</th>
    <th>Operation Type</th>
    <th>Attack Type</th>
    <th>Attack Method</th>
    <th>Status</th>
    <th>Rank</th>
    <th>Scan Date</th>
    <th>Operation</th>
  </tr>
  </thead>
  <tbody>
  {% for scan_detail in scan_details %}
  <tr>
    <td>{{ scan_detail.id }}</td>
    <td>{{ scan_detail.operation_type }}</td>
    <td>{{ scan_detail.attack_type }}</td>
    <td>{{ scan_detail.attack_method }}</td>
    <td>{{ scan_detail.status }}</td>
    <td>{{ scan_detail.rank }}</td>
    <td>{{ scan_detail.exec_end_date }}</td>
    <td>
      <a href="{{ scan_detail.report_html_path }}" class="btn btn-outline-primary btn-sm">View</a>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>

{% if is_paginated %}
<nav aria-label="Page navigation">
  <ul class="pagination">
    {% if page_obj.has_previous %}
    <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous"><span aria-hidden="true">&laquo;</span><span class="sr-only">Previous</span></a></li>
    {% else %}
    <li class="page-item disabled"><a class="page-link" href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span><span class="sr-only">Previous</span></a></li>
    {% endif %}
    {% for linkpage in page_obj.paginator.page_range %}
    {% ifequal linkpage page_obj.number %}
    <li class="page-item active"><a class="page-link" href="#">{{ linkpage }}</a></li>
    {% else %}
    <li class="page-item"><a class="page-link" href="?page={{ linkpage }}">{{ linkpage }}</a></li>
    {% endifequal %}
    {% endfor %}
    {% if page_obj.has_next %}
    <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next"><span aria-hidden="true">&raquo;</span><span class="sr-only">Next</span></a></li>
    {% else %}
    <li class="page-item disabled"><a class="page-link" href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span><span class="sr-only">Next</span></a></li>
    {% endif %}
  </ul>
</nav>
{% endif %}

<a href="{% url 'atd:target_list' %}" class="btn btn-secondary btn-sm">Back</a>

{# 削除を確認するモーダル ダイアログ #}
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Confirm</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <p>ID: <span id="del_pk"></span> is Delete?</p>
      </div>
      <div class="modal-footer">
        <a href="#" class="btn btn-primary" id="del_url">OK</a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block extra_js %}
<script>
$(function() {
  $('.del_confirm').on('click', function () {
     $("#del_pk").text($(this).data("pk"));
     $('#del_url').attr('href', $(this).data("url"));
  });
});
</script>
{% endblock %}
